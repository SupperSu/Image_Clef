/home/ubuntu/anaconda3/envs/pytorch0.4_py27/lib/python2.7/site-packages/matplotlib/__init__.py:1067: UserWarning: Duplicate key in file "/home/ubuntu/.config/matplotlib/matplotlibrc", line #2
  (fname, cnt))
/home/ubuntu/anaconda3/envs/pytorch0.4_py27/lib/python2.7/site-packages/matplotlib/__init__.py:1067: UserWarning: Duplicate key in file "/home/ubuntu/.config/matplotlib/matplotlibrc", line #3
  (fname, cnt))
/home/ubuntu/yupeng/CLEF_Updated/utils/CLEF.py:26: FutureWarning: set_value is deprecated and will be removed in a future release. Please use .at[] or .iat[] accessors instead
  self.clef.set_value(i, 'caption', caption.lower())
Namespace(batch_size=9, cap_con_train='./CaptionConceptTraining.csv', cap_con_valid='./CaptionConceptValidation.csv', image_root='/data/CaptionTraining2018', lr=0.001, num_concepts=111156, num_epochs=25, num_workers=1, shuffle=False, vocab_concept='./data/concept_voc.pkl', vocab_word_path='./utils/vocab.pkl')
use gpu!!!!!!!!!!!!!!!!!!!!!!!!!!!!
The number of captions before deletion: 199489
The number of captions after deletion: 199489
train_mil.py:36: UserWarning: invalid index of a 0-dim tensor. This will be an error in PyTorch 0.5. Use tensor.item() to convert a 0-dim tensor to a Python number
  total_step, loss.data[0],
train_mil.py:37: UserWarning: invalid index of a 0-dim tensor. This will be an error in PyTorch 0.5. Use tensor.item() to convert a 0-dim tensor to a Python number
  np.exp(loss.data[0]),
Epoch [0/25]: [0/22166], loss: 0.6955, perplexity: 2.0048, batch_f1: 0.0004
Epoch [0/25]: [1000/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0075
Epoch [0/25]: [2000/22166], loss: 0.0025, perplexity: 1.0025, batch_f1: 0.0076
Epoch [0/25]: [3000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0056
Epoch [0/25]: [4000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0033
Epoch [0/25]: [5000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0036
Epoch [0/25]: [6000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0042
Epoch [0/25]: [7000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0049
Epoch [0/25]: [8000/22166], loss: 0.0031, perplexity: 1.0031, batch_f1: 0.0107
Epoch [0/25]: [9000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0028
Epoch [0/25]: [10000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0031
Epoch [0/25]: [11000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0039
Epoch [0/25]: [12000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0032
Epoch [0/25]: [13000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0048
Epoch [0/25]: [14000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0029
Epoch [0/25]: [15000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0043
Epoch [0/25]: [16000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0056
Epoch [0/25]: [17000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0043
Epoch [0/25]: [18000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0049
Epoch [0/25]: [19000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0043
Epoch [0/25]: [20000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0030
Epoch [0/25]: [21000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0055
Epoch [0/25]: [22000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0043
Epoch [1/25]: [0/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0045
Epoch [1/25]: [1000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0061
Epoch [1/25]: [2000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0038
Epoch [1/25]: [3000/22166], loss: 0.0023, perplexity: 1.0023, batch_f1: 0.0053
Epoch [1/25]: [4000/22166], loss: 0.0009, perplexity: 1.0009, batch_f1: 0.0028
Epoch [1/25]: [5000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0029
Epoch [1/25]: [6000/22166], loss: 0.0023, perplexity: 1.0023, batch_f1: 0.0087
Epoch [1/25]: [7000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0043
Epoch [1/25]: [8000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0046
Epoch [1/25]: [9000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0058
Epoch [1/25]: [10000/22166], loss: 0.0027, perplexity: 1.0027, batch_f1: 0.0087
Epoch [1/25]: [11000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0037
Epoch [1/25]: [12000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0040
Epoch [1/25]: [13000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0055
Epoch [1/25]: [14000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0023
Epoch [1/25]: [15000/22166], loss: 0.0027, perplexity: 1.0027, batch_f1: 0.0097
Epoch [1/25]: [16000/22166], loss: 0.0021, perplexity: 1.0022, batch_f1: 0.0063
Epoch [1/25]: [17000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0050
Epoch [1/25]: [18000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0038
Epoch [1/25]: [19000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0047
Epoch [1/25]: [20000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0077
Epoch [1/25]: [21000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0048
Epoch [1/25]: [22000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0043
Epoch [2/25]: [0/22166], loss: 0.0025, perplexity: 1.0025, batch_f1: 0.0062
Epoch [2/25]: [1000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0036
Epoch [2/25]: [2000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0057
Epoch [2/25]: [3000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0069
Epoch [2/25]: [4000/22166], loss: 0.0009, perplexity: 1.0009, batch_f1: 0.0028
Epoch [2/25]: [5000/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0057
Epoch [2/25]: [6000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0052
Epoch [2/25]: [7000/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0091
Epoch [2/25]: [8000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0064
Epoch [2/25]: [9000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0047
Epoch [2/25]: [10000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0052
Epoch [2/25]: [11000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0060
Epoch [2/25]: [12000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0087
Epoch [2/25]: [13000/22166], loss: 0.0024, perplexity: 1.0024, batch_f1: 0.0060
Epoch [2/25]: [14000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0055
Epoch [2/25]: [15000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0056
Epoch [2/25]: [16000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0050
Epoch [2/25]: [17000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0036
Epoch [2/25]: [18000/22166], loss: 0.0009, perplexity: 1.0009, batch_f1: 0.0033
Epoch [2/25]: [19000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0112
Epoch [2/25]: [20000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0040
Epoch [2/25]: [21000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0027
Epoch [2/25]: [22000/22166], loss: 0.0027, perplexity: 1.0027, batch_f1: 0.0114
Epoch [3/25]: [0/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0035
Epoch [3/25]: [1000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0043
Epoch [3/25]: [2000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0047
Epoch [3/25]: [3000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0067
Epoch [3/25]: [4000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0039
Epoch [3/25]: [5000/22166], loss: 0.0023, perplexity: 1.0023, batch_f1: 0.0062
Epoch [3/25]: [6000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0058
Epoch [3/25]: [7000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0028
Epoch [3/25]: [8000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0037
Epoch [3/25]: [9000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0044
Epoch [3/25]: [10000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0048
Epoch [3/25]: [11000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0062
Epoch [3/25]: [12000/22166], loss: 0.0024, perplexity: 1.0024, batch_f1: 0.0066
Epoch [3/25]: [13000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0083
Epoch [3/25]: [14000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0044
Epoch [3/25]: [15000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0052
Epoch [3/25]: [16000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0060
Epoch [3/25]: [17000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0037
Epoch [3/25]: [18000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0069
Epoch [3/25]: [19000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0055
Epoch [3/25]: [20000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0033
Epoch [3/25]: [21000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0037
Epoch [3/25]: [22000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0060
Epoch [4/25]: [0/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0093
Epoch [4/25]: [1000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0042
Epoch [4/25]: [2000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0057
Epoch [4/25]: [3000/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0094
Epoch [4/25]: [4000/22166], loss: 0.0026, perplexity: 1.0026, batch_f1: 0.0050
Epoch [4/25]: [5000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0025
Epoch [4/25]: [6000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0057
Epoch [4/25]: [7000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0052
Epoch [4/25]: [8000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0052
Epoch [4/25]: [9000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0075
Epoch [4/25]: [10000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0038
Epoch [4/25]: [11000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0074
Epoch [4/25]: [12000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0063
Epoch [4/25]: [13000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0051
Epoch [4/25]: [14000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0045
Epoch [4/25]: [15000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0059
Epoch [4/25]: [16000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0040
Epoch [4/25]: [17000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0048
Epoch [4/25]: [18000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0081
Epoch [4/25]: [19000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0054
Epoch [4/25]: [20000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0075
Epoch [4/25]: [21000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0046
Epoch [4/25]: [22000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0093
Epoch [5/25]: [0/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0048
Epoch [5/25]: [1000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0072
Epoch [5/25]: [2000/22166], loss: 0.0028, perplexity: 1.0028, batch_f1: 0.0103
Epoch [5/25]: [3000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0084
Epoch [5/25]: [4000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0050
Epoch [5/25]: [5000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0062
Epoch [5/25]: [6000/22166], loss: 0.0027, perplexity: 1.0027, batch_f1: 0.0080
Epoch [5/25]: [7000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0088
Epoch [5/25]: [8000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0050
Epoch [5/25]: [9000/22166], loss: 0.0023, perplexity: 1.0023, batch_f1: 0.0051
Epoch [5/25]: [10000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0049
Epoch [5/25]: [11000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0055
Epoch [5/25]: [12000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0055
Epoch [5/25]: [13000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0060
Epoch [5/25]: [14000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0068
Epoch [5/25]: [15000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0077
Epoch [5/25]: [16000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0064
Epoch [5/25]: [17000/22166], loss: 0.0024, perplexity: 1.0024, batch_f1: 0.0078
Epoch [5/25]: [18000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0038
Epoch [5/25]: [19000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0062
Epoch [5/25]: [20000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0062
Epoch [5/25]: [21000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0052
Epoch [5/25]: [22000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0051
Epoch [6/25]: [0/22166], loss: 0.0024, perplexity: 1.0024, batch_f1: 0.0083
Epoch [6/25]: [1000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0045
Epoch [6/25]: [2000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0043
Epoch [6/25]: [3000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0045
Epoch [6/25]: [4000/22166], loss: 0.0028, perplexity: 1.0028, batch_f1: 0.0064
Epoch [6/25]: [5000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0067
Epoch [6/25]: [6000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0047
Epoch [6/25]: [7000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0056
Epoch [6/25]: [8000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0064
Epoch [6/25]: [9000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0046
Epoch [6/25]: [10000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0049
Epoch [6/25]: [11000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0055
Epoch [6/25]: [12000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0035
Epoch [6/25]: [13000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0049
Epoch [6/25]: [14000/22166], loss: 0.0026, perplexity: 1.0026, batch_f1: 0.0082
Epoch [6/25]: [15000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0062
Epoch [6/25]: [16000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0042
Epoch [6/25]: [17000/22166], loss: 0.0025, perplexity: 1.0025, batch_f1: 0.0089
Epoch [6/25]: [18000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0029
Epoch [6/25]: [19000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0049
Epoch [6/25]: [20000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0051
Epoch [6/25]: [21000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0045
Epoch [6/25]: [22000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0052
Epoch [7/25]: [0/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0042
Epoch [7/25]: [1000/22166], loss: 0.0037, perplexity: 1.0037, batch_f1: 0.0120
Epoch [7/25]: [2000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0048
Epoch [7/25]: [3000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0048
Epoch [7/25]: [4000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0124
Epoch [7/25]: [5000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0046
Epoch [7/25]: [6000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0062
Epoch [7/25]: [7000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0068
Epoch [7/25]: [8000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0049
Epoch [7/25]: [9000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0057
Epoch [7/25]: [10000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0045
Epoch [7/25]: [11000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0051
Epoch [7/25]: [12000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0028
Epoch [7/25]: [13000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0063
Epoch [7/25]: [14000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0052
Epoch [7/25]: [15000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0076
Epoch [7/25]: [16000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0048
Epoch [7/25]: [17000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0055
Epoch [7/25]: [18000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0030
Epoch [7/25]: [19000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0054
Epoch [7/25]: [20000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0055
Epoch [7/25]: [21000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0038
Epoch [7/25]: [22000/22166], loss: 0.0031, perplexity: 1.0031, batch_f1: 0.0118
Epoch [8/25]: [0/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0078
Epoch [8/25]: [1000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0057
Epoch [8/25]: [2000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0064
Epoch [8/25]: [3000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0090
Epoch [8/25]: [4000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0053
Epoch [8/25]: [5000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0031
Epoch [8/25]: [6000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0306
Epoch [8/25]: [7000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0046
Epoch [8/25]: [8000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0082
Epoch [8/25]: [9000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0066
Epoch [8/25]: [10000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0081
Epoch [8/25]: [11000/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0097
Epoch [8/25]: [12000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0040
Epoch [8/25]: [13000/22166], loss: 0.0024, perplexity: 1.0025, batch_f1: 0.0077
Epoch [8/25]: [14000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0043
Epoch [8/25]: [15000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0042
Epoch [8/25]: [16000/22166], loss: 0.0029, perplexity: 1.0029, batch_f1: 0.0123
Epoch [8/25]: [17000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0085
Epoch [8/25]: [18000/22166], loss: 0.0023, perplexity: 1.0023, batch_f1: 0.0088
Epoch [8/25]: [19000/22166], loss: 0.0009, perplexity: 1.0009, batch_f1: 0.0054
Epoch [8/25]: [20000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0063
Epoch [8/25]: [21000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0039
Epoch [8/25]: [22000/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0078
Epoch [9/25]: [0/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0052
Epoch [9/25]: [1000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0043
Epoch [9/25]: [2000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0062
Epoch [9/25]: [3000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0024
Epoch [9/25]: [4000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0050
Epoch [9/25]: [5000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0074
Epoch [9/25]: [6000/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0090
Epoch [9/25]: [7000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0079
Epoch [9/25]: [8000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0037
Epoch [9/25]: [9000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0031
Epoch [9/25]: [10000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0041
Epoch [9/25]: [11000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0071
Epoch [9/25]: [12000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0068
Epoch [9/25]: [13000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0049
Epoch [9/25]: [14000/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0063
Epoch [9/25]: [15000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0047
Epoch [9/25]: [16000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0042
Epoch [9/25]: [17000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0034
Epoch [9/25]: [18000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0059
Epoch [9/25]: [19000/22166], loss: 0.0026, perplexity: 1.0026, batch_f1: 0.0089
Epoch [9/25]: [20000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0067
Epoch [9/25]: [21000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0076
Epoch [9/25]: [22000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0047
Epoch [10/25]: [0/22166], loss: 0.0029, perplexity: 1.0029, batch_f1: 0.0067
Epoch [10/25]: [1000/22166], loss: 0.0024, perplexity: 1.0024, batch_f1: 0.0068
Epoch [10/25]: [2000/22166], loss: 0.0009, perplexity: 1.0009, batch_f1: 0.0076
Epoch [10/25]: [3000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0032
Epoch [10/25]: [4000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0074
Epoch [10/25]: [5000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0025
Epoch [10/25]: [6000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0068
Epoch [10/25]: [7000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0042
Epoch [10/25]: [8000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0052
Epoch [10/25]: [9000/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0063
Epoch [10/25]: [10000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0068
Epoch [10/25]: [11000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0038
Epoch [10/25]: [12000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0086
Epoch [10/25]: [13000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0117
Epoch [10/25]: [14000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0035
Epoch [10/25]: [15000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0042
Epoch [10/25]: [16000/22166], loss: 0.0024, perplexity: 1.0024, batch_f1: 0.0073
Epoch [10/25]: [17000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0034
Epoch [10/25]: [18000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0074
Epoch [10/25]: [19000/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0089
Epoch [10/25]: [20000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0038
Epoch [10/25]: [21000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0103
Epoch [10/25]: [22000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0043
Epoch [11/25]: [0/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0067
Epoch [11/25]: [1000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0056
Epoch [11/25]: [2000/22166], loss: 0.0023, perplexity: 1.0024, batch_f1: 0.0104
Epoch [11/25]: [3000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0042
Epoch [11/25]: [4000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0056
Epoch [11/25]: [5000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0051
Epoch [11/25]: [6000/22166], loss: 0.0009, perplexity: 1.0009, batch_f1: 0.0026
Epoch [11/25]: [7000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0096
Epoch [11/25]: [8000/22166], loss: 0.0009, perplexity: 1.0009, batch_f1: 0.0018
Epoch [11/25]: [9000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0058
Epoch [11/25]: [10000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0061
Epoch [11/25]: [11000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0107
Epoch [11/25]: [12000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0035
Epoch [11/25]: [13000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0052
Epoch [11/25]: [14000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0051
Epoch [11/25]: [15000/22166], loss: 0.0020, perplexity: 1.0021, batch_f1: 0.0055
Epoch [11/25]: [16000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0086
Epoch [11/25]: [17000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0065
Epoch [11/25]: [18000/22166], loss: 0.0027, perplexity: 1.0027, batch_f1: 0.0097
Epoch [11/25]: [19000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0099
Epoch [11/25]: [20000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0040
Epoch [11/25]: [21000/22166], loss: 0.0024, perplexity: 1.0024, batch_f1: 0.0181
Epoch [11/25]: [22000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0048
Epoch [12/25]: [0/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0126
Epoch [12/25]: [1000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0045
Epoch [12/25]: [2000/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0092
Epoch [12/25]: [3000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0182
Epoch [12/25]: [4000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0058
Epoch [12/25]: [5000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0045
Epoch [12/25]: [6000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0064
Epoch [12/25]: [7000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0065
Epoch [12/25]: [8000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0039
Epoch [12/25]: [9000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0068
Epoch [12/25]: [10000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0092
Epoch [12/25]: [11000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0091
Epoch [12/25]: [12000/22166], loss: 0.0023, perplexity: 1.0023, batch_f1: 0.0081
Epoch [12/25]: [13000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0036
Epoch [12/25]: [14000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0050
Epoch [12/25]: [15000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0060
Epoch [12/25]: [16000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0048
Epoch [12/25]: [17000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0050
Epoch [12/25]: [18000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0074
Epoch [12/25]: [19000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0042
Epoch [12/25]: [20000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0086
Epoch [12/25]: [21000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0074
Epoch [12/25]: [22000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0047
Epoch [13/25]: [0/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0077
Epoch [13/25]: [1000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0037
Epoch [13/25]: [2000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0071
Epoch [13/25]: [3000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0067
Epoch [13/25]: [4000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0062
Epoch [13/25]: [5000/22166], loss: 0.0021, perplexity: 1.0022, batch_f1: 0.0084
Epoch [13/25]: [6000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0048
Epoch [13/25]: [7000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0041
Epoch [13/25]: [8000/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0075
Epoch [13/25]: [9000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0036
Epoch [13/25]: [10000/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0070
Epoch [13/25]: [11000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0062
Epoch [13/25]: [12000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0066
Epoch [13/25]: [13000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0061
Epoch [13/25]: [14000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0069
Epoch [13/25]: [15000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0063
Epoch [13/25]: [16000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0075
Epoch [13/25]: [17000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0095
Epoch [13/25]: [18000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0069
Epoch [13/25]: [19000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0070
Epoch [13/25]: [20000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0036
Epoch [13/25]: [21000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0072
Epoch [13/25]: [22000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0074
Epoch [14/25]: [0/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0026
Epoch [14/25]: [1000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0050
Epoch [14/25]: [2000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0048
Epoch [14/25]: [3000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0035
Epoch [14/25]: [4000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0062
Epoch [14/25]: [5000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0096
Epoch [14/25]: [6000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0099
Epoch [14/25]: [7000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0037
Epoch [14/25]: [8000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0055
Epoch [14/25]: [9000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0041
Epoch [14/25]: [10000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0030
Epoch [14/25]: [11000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0041
Epoch [14/25]: [12000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0027
Epoch [14/25]: [13000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0030
Epoch [14/25]: [14000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0056
Epoch [14/25]: [15000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0059
Epoch [14/25]: [16000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0026
Epoch [14/25]: [17000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0048
Epoch [14/25]: [18000/22166], loss: 0.0026, perplexity: 1.0026, batch_f1: 0.0094
Epoch [14/25]: [19000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0057
Epoch [14/25]: [20000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0045
Epoch [14/25]: [21000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0083
Epoch [14/25]: [22000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0079
Epoch [15/25]: [0/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0092
Epoch [15/25]: [1000/22166], loss: 0.0024, perplexity: 1.0024, batch_f1: 0.0073
Epoch [15/25]: [2000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0048
Epoch [15/25]: [3000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0050
Epoch [15/25]: [4000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0042
Epoch [15/25]: [5000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0063
Epoch [15/25]: [6000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0086
Epoch [15/25]: [7000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0040
Epoch [15/25]: [8000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0070
Epoch [15/25]: [9000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0081
Epoch [15/25]: [10000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0100
Epoch [15/25]: [11000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0029
Epoch [15/25]: [12000/22166], loss: 0.0024, perplexity: 1.0024, batch_f1: 0.0100
Epoch [15/25]: [13000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0084
Epoch [15/25]: [14000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0031
Epoch [15/25]: [15000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0065
Epoch [15/25]: [16000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0066
Epoch [15/25]: [17000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0042
Epoch [15/25]: [18000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0067
Epoch [15/25]: [19000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0040
Epoch [15/25]: [20000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0058
Epoch [15/25]: [21000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0031
Epoch [15/25]: [22000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0107
Epoch [16/25]: [0/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0056
Epoch [16/25]: [1000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0039
Epoch [16/25]: [2000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0052
Epoch [16/25]: [3000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0091
Epoch [16/25]: [4000/22166], loss: 0.0015, perplexity: 1.0016, batch_f1: 0.0044
Epoch [16/25]: [5000/22166], loss: 0.0030, perplexity: 1.0030, batch_f1: 0.0103
Epoch [16/25]: [6000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0072
Epoch [16/25]: [7000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0112
Epoch [16/25]: [8000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0045
Epoch [16/25]: [9000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0079
Epoch [16/25]: [10000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0049
Epoch [16/25]: [11000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0056
Epoch [16/25]: [12000/22166], loss: 0.0032, perplexity: 1.0032, batch_f1: 0.0116
Epoch [16/25]: [13000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0041
Epoch [16/25]: [14000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0077
Epoch [16/25]: [15000/22166], loss: 0.0025, perplexity: 1.0025, batch_f1: 0.0123
Epoch [16/25]: [16000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0069
Epoch [16/25]: [17000/22166], loss: 0.0012, perplexity: 1.0013, batch_f1: 0.0054
Epoch [16/25]: [18000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0054
Epoch [16/25]: [19000/22166], loss: 0.0009, perplexity: 1.0009, batch_f1: 0.0052
Epoch [16/25]: [20000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0036
Epoch [16/25]: [21000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0042
Epoch [16/25]: [22000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0069
Epoch [17/25]: [0/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0080
Epoch [17/25]: [1000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0221
Epoch [17/25]: [2000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0070
Epoch [17/25]: [3000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0067
Epoch [17/25]: [4000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0069
Epoch [17/25]: [5000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0037
Epoch [17/25]: [6000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0104
Epoch [17/25]: [7000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0043
Epoch [17/25]: [8000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0043
Epoch [17/25]: [9000/22166], loss: 0.0009, perplexity: 1.0009, batch_f1: 0.0038
Epoch [17/25]: [10000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0052
Epoch [17/25]: [11000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0046
Epoch [17/25]: [12000/22166], loss: 0.0024, perplexity: 1.0024, batch_f1: 0.0087
Epoch [17/25]: [13000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0086
Epoch [17/25]: [14000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0334
Epoch [17/25]: [15000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0035
Epoch [17/25]: [16000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0053
Epoch [17/25]: [17000/22166], loss: 0.0024, perplexity: 1.0024, batch_f1: 0.0119
Epoch [17/25]: [18000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0087
Epoch [17/25]: [19000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0054
Epoch [17/25]: [20000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0096
Epoch [17/25]: [21000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0063
Epoch [17/25]: [22000/22166], loss: 0.0029, perplexity: 1.0029, batch_f1: 0.0073
Epoch [18/25]: [0/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0053
Epoch [18/25]: [1000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0072
Epoch [18/25]: [2000/22166], loss: 0.0028, perplexity: 1.0028, batch_f1: 0.0045
Epoch [18/25]: [3000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0050
Epoch [18/25]: [4000/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0077
Epoch [18/25]: [5000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0036
Epoch [18/25]: [6000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0062
Epoch [18/25]: [7000/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0113
Epoch [18/25]: [8000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0042
Epoch [18/25]: [9000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0075
Epoch [18/25]: [10000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0101
Epoch [18/25]: [11000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0038
Epoch [18/25]: [12000/22166], loss: 0.0024, perplexity: 1.0024, batch_f1: 0.0083
Epoch [18/25]: [13000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0087
Epoch [18/25]: [14000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0033
Epoch [18/25]: [15000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0075
Epoch [18/25]: [16000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0059
Epoch [18/25]: [17000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0063
Epoch [18/25]: [18000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0114
Epoch [18/25]: [19000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0054
Epoch [18/25]: [20000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0047
Epoch [18/25]: [21000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0031
Epoch [18/25]: [22000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0042
Epoch [19/25]: [0/22166], loss: 0.0027, perplexity: 1.0027, batch_f1: 0.0091
Epoch [19/25]: [1000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0048
Epoch [19/25]: [2000/22166], loss: 0.0022, perplexity: 1.0023, batch_f1: 0.0066
Epoch [19/25]: [3000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0059
Epoch [19/25]: [4000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0048
Epoch [19/25]: [5000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0035
Epoch [19/25]: [6000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0058
Epoch [19/25]: [7000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0161
Epoch [19/25]: [8000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0130
Epoch [19/25]: [9000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0048
Epoch [19/25]: [10000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0046
Epoch [19/25]: [11000/22166], loss: 0.0024, perplexity: 1.0024, batch_f1: 0.0122
Epoch [19/25]: [12000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0049
Epoch [19/25]: [13000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0051
Epoch [19/25]: [14000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0025
Epoch [19/25]: [15000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0051
Epoch [19/25]: [16000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0131
Epoch [19/25]: [17000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0040
Epoch [19/25]: [18000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0046
Epoch [19/25]: [19000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0060
Epoch [19/25]: [20000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0087
Epoch [19/25]: [21000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0033
Epoch [19/25]: [22000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0061
Epoch [20/25]: [0/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0123
Epoch [20/25]: [1000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0059
Epoch [20/25]: [2000/22166], loss: 0.0024, perplexity: 1.0024, batch_f1: 0.0099
Epoch [20/25]: [3000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0094
Epoch [20/25]: [4000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0085
Epoch [20/25]: [5000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0040
Epoch [20/25]: [6000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0028
Epoch [20/25]: [7000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0033
Epoch [20/25]: [8000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0061
Epoch [20/25]: [9000/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0072
Epoch [20/25]: [10000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0154
Epoch [20/25]: [11000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0037
Epoch [20/25]: [12000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0034
Epoch [20/25]: [13000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0037
Epoch [20/25]: [14000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0065
Epoch [20/25]: [15000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0033
Epoch [20/25]: [16000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0148
Epoch [20/25]: [17000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0060
Epoch [20/25]: [18000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0042
Epoch [20/25]: [19000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0043
Epoch [20/25]: [20000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0084
Epoch [20/25]: [21000/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0083
Epoch [20/25]: [22000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0069
Epoch [21/25]: [0/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0095
Epoch [21/25]: [1000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0048
Epoch [21/25]: [2000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0108
Epoch [21/25]: [3000/22166], loss: 0.0027, perplexity: 1.0027, batch_f1: 0.0126
Epoch [21/25]: [4000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0033
Epoch [21/25]: [5000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0095
Epoch [21/25]: [6000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0061
Epoch [21/25]: [7000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0151
Epoch [21/25]: [8000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0104
Epoch [21/25]: [9000/22166], loss: 0.0026, perplexity: 1.0026, batch_f1: 0.0104
Epoch [21/25]: [10000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0052
Epoch [21/25]: [11000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0044
Epoch [21/25]: [12000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0072
Epoch [21/25]: [13000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0071
Epoch [21/25]: [14000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0084
Epoch [21/25]: [15000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0082
Epoch [21/25]: [16000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0108
Epoch [21/25]: [17000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0227
Epoch [21/25]: [18000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0070
Epoch [21/25]: [19000/22166], loss: 0.0025, perplexity: 1.0025, batch_f1: 0.0087
Epoch [21/25]: [20000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0051
Epoch [21/25]: [21000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0059
Epoch [21/25]: [22000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0036
Epoch [22/25]: [0/22166], loss: 0.0025, perplexity: 1.0025, batch_f1: 0.0095
Epoch [22/25]: [1000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0068
Epoch [22/25]: [2000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0066
Epoch [22/25]: [3000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0046
Epoch [22/25]: [4000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0033
Epoch [22/25]: [5000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0081
Epoch [22/25]: [6000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0066
Epoch [22/25]: [7000/22166], loss: 0.0029, perplexity: 1.0029, batch_f1: 0.0095
Epoch [22/25]: [8000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0055
Epoch [22/25]: [9000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0092
Epoch [22/25]: [10000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0065
Epoch [22/25]: [11000/22166], loss: 0.0025, perplexity: 1.0025, batch_f1: 0.0100
Epoch [22/25]: [12000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0087
Epoch [22/25]: [13000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0049
Epoch [22/25]: [14000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0061
Epoch [22/25]: [15000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0090
Epoch [22/25]: [16000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0074
Epoch [22/25]: [17000/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0069
Epoch [22/25]: [18000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0033
Epoch [22/25]: [19000/22166], loss: 0.0013, perplexity: 1.0013, batch_f1: 0.0107
Epoch [22/25]: [20000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0038
Epoch [22/25]: [21000/22166], loss: 0.0009, perplexity: 1.0009, batch_f1: 0.0049
Epoch [22/25]: [22000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0073
Epoch [23/25]: [0/22166], loss: 0.0025, perplexity: 1.0025, batch_f1: 0.0088
Epoch [23/25]: [1000/22166], loss: 0.0019, perplexity: 1.0019, batch_f1: 0.0066
Epoch [23/25]: [2000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0055
Epoch [23/25]: [3000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0053
Epoch [23/25]: [4000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0078
Epoch [23/25]: [5000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0049
Epoch [23/25]: [6000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0033
Epoch [23/25]: [7000/22166], loss: 0.0010, perplexity: 1.0010, batch_f1: 0.0040
Epoch [23/25]: [8000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0060
Epoch [23/25]: [9000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0091
Epoch [23/25]: [10000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0057
Epoch [23/25]: [11000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0106
Epoch [23/25]: [12000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0097
Epoch [23/25]: [13000/22166], loss: 0.0025, perplexity: 1.0025, batch_f1: 0.0082
Epoch [23/25]: [14000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0057
Epoch [23/25]: [15000/22166], loss: 0.0018, perplexity: 1.0019, batch_f1: 0.0080
Epoch [23/25]: [16000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0126
Epoch [23/25]: [17000/22166], loss: 0.0017, perplexity: 1.0017, batch_f1: 0.0125
Epoch [23/25]: [18000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0065
Epoch [23/25]: [19000/22166], loss: 0.0009, perplexity: 1.0009, batch_f1: 0.0028
Epoch [23/25]: [20000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0032
Epoch [23/25]: [21000/22166], loss: 0.0016, perplexity: 1.0016, batch_f1: 0.0051
Epoch [23/25]: [22000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0038
Epoch [24/25]: [0/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0047
Epoch [24/25]: [1000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0071
Epoch [24/25]: [2000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0065
Epoch [24/25]: [3000/22166], loss: 0.0009, perplexity: 1.0009, batch_f1: 0.0033
Epoch [24/25]: [4000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0046
Epoch [24/25]: [5000/22166], loss: 0.0018, perplexity: 1.0018, batch_f1: 0.0062
Epoch [24/25]: [6000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0038
Epoch [24/25]: [7000/22166], loss: 0.0021, perplexity: 1.0021, batch_f1: 0.0104
Epoch [24/25]: [8000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0060
Epoch [24/25]: [9000/22166], loss: 0.0022, perplexity: 1.0022, batch_f1: 0.0064
Epoch [24/25]: [10000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0072
Epoch [24/25]: [11000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0075
Epoch [24/25]: [12000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0055
Epoch [24/25]: [13000/22166], loss: 0.0012, perplexity: 1.0012, batch_f1: 0.0076
Epoch [24/25]: [14000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0074
Epoch [24/25]: [15000/22166], loss: 0.0020, perplexity: 1.0020, batch_f1: 0.0071
Epoch [24/25]: [16000/22166], loss: 0.0025, perplexity: 1.0025, batch_f1: 0.0077
Epoch [24/25]: [17000/22166], loss: 0.0011, perplexity: 1.0011, batch_f1: 0.0041
Epoch [24/25]: [18000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0124
Epoch [24/25]: [19000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0064
Epoch [24/25]: [20000/22166], loss: 0.0014, perplexity: 1.0014, batch_f1: 0.0061
Epoch [24/25]: [21000/22166], loss: 0.0015, perplexity: 1.0015, batch_f1: 0.0042
Epoch [24/25]: [22000/22166], loss: 0.0031, perplexity: 1.0031, batch_f1: 0.0053
Traceback (most recent call last):
  File "train_mil.py", line 121, in <module>
    args = parser.parse_args()
  File "train_mil.py", line 95, in main
    train(train_data, md, optimizer, criterion, ep, epoch)
  File "/home/ubuntu/anaconda3/envs/pytorch0.4_py27/lib/python2.7/site-packages/torch/serialization.py", line 161, in save
    return _with_file_like(f, "wb", lambda f: _save(obj, f, pickle_module, pickle_protocol))
  File "/home/ubuntu/anaconda3/envs/pytorch0.4_py27/lib/python2.7/site-packages/torch/serialization.py", line 118, in _with_file_like
    return body(f)
  File "/home/ubuntu/anaconda3/envs/pytorch0.4_py27/lib/python2.7/site-packages/torch/serialization.py", line 161, in <lambda>
    return _with_file_like(f, "wb", lambda f: _save(obj, f, pickle_module, pickle_protocol))
  File "/home/ubuntu/anaconda3/envs/pytorch0.4_py27/lib/python2.7/site-packages/torch/serialization.py", line 238, in _save
    serialized_storages[key]._write_file(f, _is_real_file(f))
RuntimeError: Unknown error -1
